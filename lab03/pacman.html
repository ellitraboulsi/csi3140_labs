<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>1D PacMan</title>
    <style>
        #gameBoard {
            font-family: monospace;
            white-space: pre;
        }
    </style>
</head>
<body>
    <div id="gameBoard"></div>
    <div>Score: <span id="score">0</span></div>
    <script>
        let score = 0;

        function createGame(n) {
            const game = new Array(n).fill(".");
            const pacmanIndex = Math.floor(n / 2);
            game[pacmanIndex] = "C";
            game[Math.floor(Math.random() * n)] = "^";
            game[Math.floor(Math.random() * n)] = "@";
            return game;
        }

        function moveLeft(game) {
            const index = game.indexOf("C");
            if (index > 0) {
                if (game[index - 1] === ".") score++;
                game[index] = ".";
                game[index - 1] = "C";
            }
            checkLevelCompletion(game);
            return game;
        }

        function moveRight(game) {
            const index = game.indexOf("C");
            if (index < game.length - 1) {
                if (game[index + 1] === ".") score++;
                game[index] = ".";
                game[index + 1] = "C";
            }
            checkLevelCompletion(game);
            return game;
        }

        function checkLevelCompletion(game) {
            if (!game.includes(".")) {
                console.log("Level completed!");
                game = createGame(game.length);
                updateDisplay(game);
            }
        }

        function moveGhost(game) {
            const ghostIndex = game.indexOf("^");
            const direction = Math.random() > 0.5 ? 1 : -1;
            if ((ghostIndex > 0 && direction === -1) || (ghostIndex < game.length - 1 && direction === 1)) {
                game[ghostIndex] = ".";
                game[ghostIndex + direction] = "^";
            }
        }

        function startGhostMovement(game) {
            setInterval(() => {
                moveGhost(game);
                updateDisplay(game);
            }, 2000);
        }

        function updateDisplay(game) {
            document.getElementById("gameBoard").textContent = game.join("");
            document.getElementById("score").textContent = score;
        }

        let game = createGame(10);
        updateDisplay(game);
        startGhostMovement(game);

        // Adding event listeners for manual testing
        document.addEventListener('keydown', (event) => {
            if (event.key === 'ArrowLeft') {
                moveLeft(game);
                updateDisplay(game);
            } else if (event.key === 'ArrowRight') {
                moveRight(game);
                updateDisplay(game);
            }
        });
    </script>
</body>
</html>
